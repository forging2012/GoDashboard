using System.Linq;
using GoDashboard.Web.Modules;
using GoDashboard.Web.ViewModels;
using NUnit.Framework;

namespace GoDashboard.Web.Tests.Module
{
    [TestFixture]
    public class TestDashboard
    {
        [Test]
        public void TestPipelinesReturnsSomething()
        {
            string content =
                "<?xml version='1.0' encoding='utf-8'?><Projects>"
                + "<Project name='Shared-GoogleSiteSearch :: build'"
                + " activity='Sleeping' lastBuildStatus='Success'"
                + " lastBuildLabel='69807' lastBuildTime='2012-01-23T13:40:48'"
                + " webUrl='http://go.laterooms.com:8153/go/pipelines/Shared-GoogleSiteSearch/1/build/1' />"
                + "</Projects>";

            DisplayablePipeline pipeline = new DashBoard(content).Pipelines().First();

            Assert.That(pipeline.Name, Is.EqualTo("Shared"));
        }

        [Test]
        public void TestGetContent()
        {
            string password = "Password1";
            string username = "script-readonly";
            var dashBoard = new DashBoard(username, password);

            Assert.That(dashBoard.GetContent("http://go.laterooms.com:8153/go/cctray.xml"), Is.Not.Null);
        }
    }
}